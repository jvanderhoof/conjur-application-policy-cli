- !policy
  id: app-foo
  body:
  - &variables
    - !variable
      id: secret1
    - !variable
      id: secret
    - !variable
      id: 2
    - !variable
      id: secret3

  - !layer

  - !group secrets-users
  - !group secrets-managers

  # secrets-users can read and execute
  - !permit
    resource: *variables
    privileges: [ read, execute ]
    role: !group secrets-users

  # secrets-managers can update (and read and execute, via role grant)
  - !permit
    resource: *variables
    privileges: [ update ]
    role: !group secrets-managers

  # secrets-managers has role secrets-users
  - !grant
    member: !group secrets-managers
    role: !group secrets-users

# Application layer has the secrets-users role
  - !grant
    member: !layer
    role: !group secrets-users
